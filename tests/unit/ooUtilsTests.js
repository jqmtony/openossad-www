'use strict';

/* jasmine specs for services go here */

describe('ooUtils', function() {

    describe('parseXml', function() {
        it('should return xml with plain diagram', function() {
            var xml = '<mxfile userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36" type="browser"><diagram>&lt;mxGraphModel dx="800" dy="800" grid="1" guides="1" tooltips="1" connect="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" style="default-style2"&gt;&lt;root&gt;&lt;mxCell id="0"/&gt;&lt;mxCell id="1" parent="0"/&gt;&lt;mxCell id="2" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="3" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="4" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="5" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="6" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="7" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="8" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="9" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;</diagram></mxfile>';
            var actual = ooUtils.parseXml(xml);
            var expected = 'mxfile';
            expect(actual.documentElement.nodeName).toEqual(expected);
        });
        it('should return xml with compressed diagram', function() {
            var xml = '<mxfile userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36" type="browser"><diagram>JTNDbXhHcmFwaE1vZGVsJTIwZHglM0QlMjI4MDAlMjIlMjBkeSUzRCUyMjgwMCUyMiUyMGdyaWQlM0QlMjIxJTIyJTIwZ3VpZGVzJTNEJTIyMSUyMiUyMHRvb2x0aXBzJTNEJTIyMSUyMiUyMGNvbm5lY3QlM0QlMjIxJTIyJTIwZm9sZCUzRCUyMjElMjIlMjBwYWdlJTNEJTIyMSUyMiUyMHBhZ2VTY2FsZSUzRCUyMjElMjIlMjBwYWdlV2lkdGglM0QlMjI4MjYlMjIlMjBwYWdlSGVpZ2h0JTNEJTIyMTE2OSUyMiUyMHN0eWxlJTNEJTIyZGVmYXVsdC1zdHlsZTIlMjIlM0UlM0Nyb290JTNFJTNDbXhDZWxsJTIwaWQlM0QlMjIwJTIyJTJGJTNFJTNDbXhDZWxsJTIwaWQlM0QlMjIxJTIyJTIwcGFyZW50JTNEJTIyMCUyMiUyRiUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyMiUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyMyUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNCUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNSUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNiUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNyUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQyUyRnJvb3QlM0UlM0MlMkZteEdyYXBoTW9kZWwlM0U=</diagram></mxfile>';
            var actual = ooUtils.parseXml(xml);
            var expected = 'mxfile';
            expect(expected).toEqual(actual.documentElement.nodeName);
        });
    });
    describe('extractDiagram', function() {
        it('should exception when string diagram from non base 64', function() {
            var xml = '<mxfile userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36" type="browser"><diagram>&lt;mxGraphModel dx="800" dy="800" grid="1" guides="1" tooltips="1" connect="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" style="default-style2"&gt;&lt;root&gt;&lt;mxCell id="0"/&gt;&lt;mxCell id="1" parent="0"/&gt;&lt;mxCell id="2" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="3" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="4" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="5" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="6" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="300" height="300" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="7" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="8" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;mxCell id="9" value="Process" vertex="1" parent="1"&gt;&lt;mxGeometry x="10" y="10" width="200" height="200" as="geometry"/&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;</diagram></mxfile>';
            var actual = true;
            try{
                ooUtils.extractDiagram(xml);
                // exception must jump lines below
                actual=false;
                expect(false).toBeTruthy();
            } catch(e){
                expect(actual).toBeTruthy();
            }
        });
        it('should work with compressed diagram', function() {
            var xml = '<mxfile userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36" type="browser"><diagram>JTNDbXhHcmFwaE1vZGVsJTIwZHglM0QlMjI4MDAlMjIlMjBkeSUzRCUyMjgwMCUyMiUyMGdyaWQlM0QlMjIxJTIyJTIwZ3VpZGVzJTNEJTIyMSUyMiUyMHRvb2x0aXBzJTNEJTIyMSUyMiUyMGNvbm5lY3QlM0QlMjIxJTIyJTIwZm9sZCUzRCUyMjElMjIlMjBwYWdlJTNEJTIyMSUyMiUyMHBhZ2VTY2FsZSUzRCUyMjElMjIlMjBwYWdlV2lkdGglM0QlMjI4MjYlMjIlMjBwYWdlSGVpZ2h0JTNEJTIyMTE2OSUyMiUyMHN0eWxlJTNEJTIyZGVmYXVsdC1zdHlsZTIlMjIlM0UlM0Nyb290JTNFJTNDbXhDZWxsJTIwaWQlM0QlMjIwJTIyJTJGJTNFJTNDbXhDZWxsJTIwaWQlM0QlMjIxJTIyJTIwcGFyZW50JTNEJTIyMCUyMiUyRiUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyMiUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyMyUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNCUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMjAwJTIyJTIwaGVpZ2h0JTNEJTIyMjAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNSUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNiUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQ214Q2VsbCUyMGlkJTNEJTIyNyUyMiUyMHZhbHVlJTNEJTIyUHJvY2VzcyUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTNFJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIxMCUyMiUyMHklM0QlMjIxMCUyMiUyMHdpZHRoJTNEJTIyMzAwJTIyJTIwaGVpZ2h0JTNEJTIyMzAwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyRiUzRSUzQyUyRm14Q2VsbCUzRSUzQyUyRnJvb3QlM0UlM0MlMkZteEdyYXBoTW9kZWwlM0U=</diagram></mxfile>';
            var actual = ooUtils.extractDiagram(xml);
            var expected = '<mxGraphModel dx="800" dy="800" grid="1" guides="1" tooltips="1" connect="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" style="default-style2"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="2" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="200" height="200" as="geometry"/></mxCell><mxCell id="3" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="200" height="200" as="geometry"/></mxCell><mxCell id="4" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="200" height="200" as="geometry"/></mxCell><mxCell id="5" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="300" height="300" as="geometry"/></mxCell><mxCell id="6" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="300" height="300" as="geometry"/></mxCell><mxCell id="7" value="Process" vertex="1" parent="1"><mxGeometry x="10" y="10" width="300" height="300" as="geometry"/></mxCell></root></mxGraphModel>';
            expect(expected).toEqual(actual);
        });

        it('should return mxGraphModel when passed mxGraphModel node',function() {
            var xml = '<mxGraphModel dx="800" dy="800" grid="0" guides="0" tooltips="1" connect="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" style="default-style2"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="34" value="" style="shape=mxgraph.basic.octagon;fillColor=#E6FFCC;strokeColor=#1A3300;strokeWidth=3" vertex="1" parent="1"><mxGeometry x="50.5" y="400" width="359" height="300" as="geometry"/></mxCell><mxCell id="35" value="" style="shape=mxgraph.basic.octagon;fillColor=#E6FFCC;strokeColor=#1A3300;strokeWidth=3" vertex="1" parent="1"><mxGeometry x="409" y="400" width="359" height="300" as="geometry"/></mxCell><mxCell id="33" value="" style="shape=mxgraph.basic.octagon;fillColor=#E6FFCC;strokeColor=#1A3300;strokeWidth=3" vertex="1" parent="1"><mxGeometry x="409" y="100" width="359" height="300" as="geometry"/></mxCell><mxCell id="32" value="" style="shape=mxgraph.basic.octagon;fillColor=#E6FFCC;strokeColor=#1A3300;strokeWidth=3" vertex="1" parent="1"><mxGeometry x="50" y="100" width="359" height="300" as="geometry"/></mxCell><mxCell id="14" value="- internal strength 1&#xa;- internal strength 2&#xa;- internal strength 3&#xa;- internal strength 4&#xa;- internal strength 5&#xa;- internal strength 6&#xa;- internal strength 7&#xa;- internal strength 8&#xa;- internal strength 9&#xa;- internal strength 10&#xa;" style="text;spacingTop=-5;verticalAlign=middle" parent="1" vertex="1"><mxGeometry x="120" y="140" width="270" height="240" as="geometry"/></mxCell><mxCell id="15" value="- internal weakness 1&#xa;- internal weakness 2&#xa;- internal weakness 3&#xa;- internal weakness 4&#xa;- internal weakness 5&#xa;- internal weakness 6&#xa;- internal weakness 7&#xa;- internal weakness 8&#xa;- internal weakness 9&#xa;- internal weakness 10&#xa;" style="text;spacingTop=-5;verticalAlign=middle" parent="1" vertex="1"><mxGeometry x="490" y="140" width="260" height="242.5" as="geometry"/></mxCell><mxCell id="16" value="- external opportunity 1&#xa;- external opportunity 2&#xa;- external opportunity 3&#xa;- external opportunity 4&#xa;- external opportunity 5&#xa;- external opportunity 6&#xa;- external opportunity 7&#xa;- external opportunity 8&#xa;- external opportunity 9&#xa;- external opportunity 10&#xa;" style="text;spacingTop=-5;verticalAlign=middle" parent="1" vertex="1"><mxGeometry x="120" y="420" width="270" height="260" as="geometry"/></mxCell><mxCell id="17" value="- external threat 1&#xa;- external threat 2&#xa;- external threat 3&#xa;- external threat 4&#xa;- external threat 5&#xa;- external threat 6&#xa;- external threat 7&#xa;- external threat 8&#xa;- external threat 9&#xa;- external threat 10&#xa;" style="text;spacingTop=-5;verticalAlign=middle" parent="1" vertex="1"><mxGeometry x="490" y="420" width="260" height="260" as="geometry"/></mxCell><mxCell id="18" value="SUBJECT DESCRIPTION SWOT ANALYSIS" style="text;spacingTop=-5;align=center;verticalAlign=middle;fontSize=18;fontStyle=1" parent="1" vertex="1"><mxGeometry x="20" y="10" width="750" height="40" as="geometry"/></mxCell><mxCell id="36" value="" style="rhombus;whiteSpace=wrap;strokeColor=#1A3300;fillColor=#E6FFCC;strokeWidth=3" vertex="1" parent="1"><mxGeometry x="314" y="320" width="190" height="160" as="geometry"/></mxCell><mxCell id="37" value="S" style="text;spacingTop=-5;align=right;verticalAlign=bottom;fontSize=36;fontColor=#1A3300" vertex="1" parent="1"><mxGeometry x="320" y="320" width="80" height="70" as="geometry"/></mxCell><mxCell id="38" value="W" style="text;spacingTop=-5;align=left;verticalAlign=bottom;fontSize=36;fontColor=#1A3300" vertex="1" parent="1"><mxGeometry x="410" y="320" width="80" height="70" as="geometry"/></mxCell><mxCell id="39" value="O" style="text;spacingTop=-5;align=right;verticalAlign=top;fontSize=36;fontColor=#1A3300" vertex="1" parent="1"><mxGeometry x="320" y="400" width="80" height="70" as="geometry"/></mxCell><mxCell id="40" value="T" style="text;spacingTop=-5;align=left;verticalAlign=top;fontSize=36;fontColor=#1A3300" vertex="1" parent="1"><mxGeometry x="417" y="399" width="80" height="70" as="geometry"/></mxCell></root></mxGraphModel>';
            var actual = ooUtils.extractDiagram(xml);
            var expected = 'mxGraphModel';
            expect(expected).toEqual(actual.documentElement.nodeName);
        });
    });
});